<!DOCTYPE html>
<html lang="ru-RU">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Базовые понятия | Actors</title>
    <meta name="description" content="Компонентно-ориентированный паттерн для Unity3D">
    <link rel="icon" href="/Actors-Unity3d-Framework/logo.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/Actors-Unity3d-Framework/assets/css/0.styles.0bb851bb.css" as="style"><link rel="preload" href="/Actors-Unity3d-Framework/assets/js/app.bffbe60e.js" as="script"><link rel="preload" href="/Actors-Unity3d-Framework/assets/js/3.45fed496.js" as="script"><link rel="prefetch" href="/Actors-Unity3d-Framework/assets/js/4.f6529715.js"><link rel="prefetch" href="/Actors-Unity3d-Framework/assets/js/vendors~docsearch.1bc44d2d.js"><link rel="prefetch" href="/Actors-Unity3d-Framework/assets/js/2.5d28b7b4.js"><link rel="prefetch" href="/Actors-Unity3d-Framework/assets/js/5.f8de191a.js"><link rel="prefetch" href="/Actors-Unity3d-Framework/assets/js/6.38cbd466.js"><link rel="prefetch" href="/Actors-Unity3d-Framework/assets/js/7.f28e9f2e.js"><link rel="prefetch" href="/Actors-Unity3d-Framework/assets/js/8.aa56240c.js"><link rel="prefetch" href="/Actors-Unity3d-Framework/assets/js/9.ae1e6e90.js">
    <link rel="stylesheet" href="/Actors-Unity3d-Framework/assets/css/0.styles.0bb851bb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/Actors-Unity3d-Framework/ru/" class="home-link router-link-active"><!----><span class="site-name">
      Actors
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/Actors-Unity3d-Framework/guide/" class="nav-link">Руководство</a></div><div class="nav-item"><a href="https://www.youtube.com/channel/UC0jx4_kcQAHsifu1zH4U1qw" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Youtube Канал
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Язык</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/Actors-Unity3d-Framework/guide/basic-stuff.html" class="nav-link">English</a></li><li class="dropdown-item"><!----><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html" class="nav-link router-link-exact-active router-link-active">Русский</a></li></ul></div></div><a href="https://github.com/dimmpixeye/Actors-Unity3d-Framework" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Actors-Unity3d-Framework/guide/" class="nav-link">Руководство</a></div><div class="nav-item"><a href="https://www.youtube.com/channel/UC0jx4_kcQAHsifu1zH4U1qw" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Youtube Канал
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Язык</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/Actors-Unity3d-Framework/guide/basic-stuff.html" class="nav-link">English</a></li><li class="dropdown-item"><!----><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html" class="nav-link router-link-exact-active router-link-active">Русский</a></li></ul></div></div><a href="https://github.com/dimmpixeye/Actors-Unity3d-Framework" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Руководство</span><!----></p><ul class="sidebar-group-items"><li><a href="/Actors-Unity3d-Framework/ru/guide/" class="sidebar-link">Введение</a></li><li><a href="/Actors-Unity3d-Framework/ru/guide/setup.html" class="sidebar-link">Установка</a></li><li><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html" class="active sidebar-link">Базовые понятия</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#обзор-акторов" class="sidebar-link">Обзор акторов</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#компонент-данных" class="sidebar-link">Компонент данных</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#компонент-поведения-behavior" class="sidebar-link">Компонент поведения (Behavior)</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#сигнаnы" class="sidebar-link">Сигналы</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#обзор-интерфейсов" class="sidebar-link">Обзор интерфейсов</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#toolbox" class="sidebar-link">Toolbox</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#обработчики" class="sidebar-link">Обработчики</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#обработчики-фреймворка" class="sidebar-link">Обработчики фреймворка</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#пуn-объектов" class="sidebar-link">Пул объектов</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#создание-и-уничтожение-новых-объектов" class="sidebar-link">Создание и уничтожение новых объектов</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#таймеры" class="sidebar-link">Таймеры</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#схемы-blueprint" class="sidebar-link">Схемы (Blueprint)</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#теги" class="sidebar-link">Теги</a></li><li class="sidebar-sub-header"><a href="/Actors-Unity3d-Framework/ru/guide/basic-stuff.html#ecs" class="sidebar-link">ECS</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="базовые-понятия"><a href="#базовые-понятия" aria-hidden="true" class="header-anchor">#</a> Базовые понятия</h1><h2 id="обзор-акторов"><a href="#обзор-акторов" aria-hidden="true" class="header-anchor">#</a> Обзор акторов</h2><p>С этого момента мы готовы создавать новые gameobject'ы.</p><h3 id="monocached"><a href="#monocached" aria-hidden="true" class="header-anchor">#</a> Monocached</h3><p>Вместо использования Monobehavior'ов рекомендуется использовать классы Monocached.
Вы можете настроить время уничтожения и типы пулов для вашего объекта. Если пул назначен объект будет деактивирован и кэширован. Если пул не назначен, то объект будет уничтожен. Объединение в пулы это отличная концепция для объектов, которые постоянно создаются. Например для пуль.</p><h3 id="акторы-actors"><a href="#акторы-actors" aria-hidden="true" class="header-anchor">#</a> Акторы (Actors)</h3><p>Базовый класс для всех ваших акторов в игре. Наследуется от Monocached. Это контейнер для ваших компонентов данных и поведения (data&amp;behaviors). Когда вам нужно добавить новую игровую сущность наследуйте ее от класса Actor. Например: ActorPlayer : Actor.
Акторы это единственные компоненты влияющие на игровую логику объектов.</p><h4 id="пример-настойки-актора"><a href="#пример-настойки-актора" aria-hidden="true" class="header-anchor">#</a> Пример настойки актора</h4><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Наследуйтесь от Аctor. Так же наследуйтесь от интерфейса ITick чтобы обозначить этот объект обновляемым.</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ActorPlayer</span> <span class="token punctuation">:</span> <span class="token class-name">Actor</span><span class="token punctuation">,</span> ITick
<span class="token punctuation">{</span>
    <span class="token comment">// добавьте сериализуемые классы данных к ActorPlayer для того чтобы видеть их в инспекторе</span>
    <span class="token comment">// Используйте [FoldoutGroup(&quot;Setup&quot;)] что бы добавить классные вкладки для переменных в инспекторе</span>
	<span class="token punctuation">[</span><span class="token class-name">FoldoutGroup</span><span class="token punctuation">(</span><span class="token string">&quot;Setup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token class-name">DataMove</span> dataMove<span class="token punctuation">;</span>
	
        <span class="token comment">// Используйте protected override void Setup для инициализации актора.</span>
        <span class="token comment">// Setup используется для добавления компонентов данных в контейнер актора и создания скриптов поведения для него.</span>
    	<span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">Setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
            <span class="token comment">// используйте Add&lt;T&gt;() для создания нового объекта и добавления его в контейнер актора. Например компоненты данных ( data ).</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataMove<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// используйте Add&lt;T&gt;() для создания нового объекта и добавления его в контейнер актора. Например поведения ( behavior ).</span>
			<span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">BehaviorInput</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://gyazo.com/f3960af1f36566e3d114d97af9e3f0b6" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/f3960af1f36566e3d114d97af9e3f0b6.png" alt="https://gyazo.com/f3960af1f36566e3d114d97af9e3f0b6"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>Вам не нужно писать никакой логики внутри классов актора. Вместо этого используйте классы поведения (behavior). Обычно класс вашего актора должен быть похож на этот:</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ActorHero</span> <span class="token punctuation">:</span> <span class="token class-name">Actor</span><span class="token punctuation">,</span> ITickFixed<span class="token punctuation">,</span> ITick<span class="token punctuation">,</span> ITickLate
	<span class="token punctuation">{</span>
		<span class="token punctuation">[</span><span class="token class-name">FoldoutGroup</span><span class="token punctuation">(</span><span class="token string">&quot;Setup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SerializeField<span class="token punctuation">]</span>
		<span class="token keyword">private</span> <span class="token class-name">DataBlueprint</span> dataBlueprint<span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">FoldoutGroup</span><span class="token punctuation">(</span><span class="token string">&quot;Setup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> HideInInspector<span class="token punctuation">,</span> SerializeField<span class="token punctuation">]</span>
		<span class="token keyword">private</span> <span class="token class-name">DataAnimationState</span> dataAnimationState<span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">FoldoutGroup</span><span class="token punctuation">(</span><span class="token string">&quot;Setup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SerializeField<span class="token punctuation">]</span>
		<span class="token keyword">private</span> <span class="token class-name">DataInput</span> dataInput<span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">FoldoutGroup</span><span class="token punctuation">(</span><span class="token string">&quot;Setup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SerializeField<span class="token punctuation">]</span>
		<span class="token keyword">private</span> <span class="token class-name">DataHealth</span> dataHealth<span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">FoldoutGroup</span><span class="token punctuation">(</span><span class="token string">&quot;Setup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SerializeField<span class="token punctuation">]</span>
		<span class="token keyword">private</span> <span class="token class-name">DataDepthRender</span> dataDepthRender<span class="token punctuation">;</span>



		<span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">Setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataBlueprint<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataAnimationState<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataDepthRender<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataHealth<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataInput<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
			<span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">DecorateDamageReturn</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">DecorateBloodFloor</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">DecorateDamageBlink</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">DecorateBloodSplats</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">BehaviorTurn</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">BehaviorMove</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">BehaviorRoll</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			<span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">BehaviorPlayerInput</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">BehaviorDamageble</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><h3 id="метод-get"><a href="#метод-get" aria-hidden="true" class="header-anchor">#</a> Метод Get</h3><p>Когда вы работете с акторами/поведением используйте Get&lt;T&gt; вместо GetComponent&lt;T&gt;. Метод Get&lt;T&gt; попытается найти компонент внутри актора.
Пример:</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token generic-method"><span class="token function">Get</span><span class="token punctuation">&lt;</span><span class="token class-name">DataMovement</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>facing
</code></pre></div><p>Вы можете получать компоненты unity так же легко, просто добавив путь к дочернему transform</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>labelScore <span class="token operator">=</span> <span class="token generic-method"><span class="token function">Get</span><span class="token punctuation">&lt;</span><span class="token class-name">TextMeshProUGUI</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;anchor_left/label_score&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="компонент-данных"><a href="#компонент-данных" aria-hidden="true" class="header-anchor">#</a> Компонент данных</h2><p>Компоненты данных это обычные, сериализуемые c# классы, наследованные от интерфейса IData. Все ваши игровые переменные хранятся в компонентах данных.
Одни и те же компоненты данных могут совместно использоваться различными поведениям.</p><h3 id="пример-компонента-данных"><a href="#пример-компонента-данных" aria-hidden="true" class="header-anchor">#</a> Пример компонента данных</h3><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Помещайте [System.Serializable] ко всем компонентам данных и проверяйте на наследование от IData</span>
	<span class="token punctuation">[</span><span class="token class-name">System<span class="token punctuation">.</span>Serializable</span><span class="token punctuation">]</span>
    <span class="token comment">// Inhe</span>
	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataMove</span> <span class="token punctuation">:</span> <span class="token class-name">IData</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">public</span> <span class="token keyword">float</span> x<span class="token punctuation">;</span>
		<span class="token keyword">public</span> <span class="token keyword">float</span> y<span class="token punctuation">;</span>

		<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><h4 id="интерфейс-isetup"><a href="#интерфейс-isetup" aria-hidden="true" class="header-anchor">#</a> Интерфейс ISetup</h4><p>Иногда необходима настройка компонента данных после запуска приложения. Наследуйте компонент данных от интерфейса ISetup, чтобы предоставить дополнительную настройку. Когда они будут добавлены к актору он проверит все компоненты на наличие интерфейса ISetup и запустит их.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>
	<span class="token punctuation">[</span><span class="token class-name">System<span class="token punctuation">.</span>Serializable</span><span class="token punctuation">]</span>
	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataMove</span> <span class="token punctuation">:</span> <span class="token class-name">IData</span><span class="token punctuation">,</span> ISetup
	<span class="token punctuation">{</span>
		<span class="token keyword">public</span> <span class="token keyword">float</span> x<span class="token punctuation">;</span>
		<span class="token keyword">public</span> <span class="token keyword">float</span> y<span class="token punctuation">;</span>

		<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Setup</span><span class="token punctuation">(</span><span class="token class-name">Actor</span> actor<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			x <span class="token operator">=</span> actor<span class="token punctuation">.</span>selfTransform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><h2 id="компонент-поведения-behavior"><a href="#компонент-поведения-behavior" aria-hidden="true" class="header-anchor">#</a> Компонент поведения (Behavior)</h2><p>Поведения это обычные классы c#, живущие только внутри акторов, которым нужны компоненты данных для работы. Компоненты поведения это рабочие лошадки акторов, ведь именно они определяют как акторы будет себя вести на сцене.</p><h3 id="пример-компонента-поведения"><a href="#пример-компонента-поведения" aria-hidden="true" class="header-anchor">#</a> Пример компонента поведения</h3><div class="language-csharp extra-class"><pre class="language-csharp"><code>
<span class="token comment">// Наследуйтесь от ITick чтобы пометить это поведение обновляемым</span>
		<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BehaviorInput</span> <span class="token punctuation">:</span> <span class="token class-name">Behavior</span><span class="token punctuation">,</span> ITick
	<span class="token punctuation">{</span>
        <span class="token comment">// Используйте атрибут [Bind] для ленивой инициализации из актора</span>
		<span class="token punctuation">[</span><span class="token class-name">Bind</span><span class="token punctuation">]</span> <span class="token keyword">private</span> <span class="token class-name">DataMove</span> dataMove<span class="token punctuation">;</span>

        <span class="token comment">// Аналог стандартного Update , добавляем переменные dataMove.</span>
		<span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			dataMove<span class="token punctuation">.</span>x <span class="token operator">=</span> Input<span class="token punctuation">.</span><span class="token function">GetAxis</span><span class="token punctuation">(</span><span class="token string">&quot;Horizontal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			dataMove<span class="token punctuation">.</span>y <span class="token operator">=</span> Input<span class="token punctuation">.</span><span class="token function">GetAxis</span><span class="token punctuation">(</span><span class="token string">&quot;Vertical&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><h2 id="сигнаnы"><a href="#сигнаnы" aria-hidden="true" class="header-anchor">#</a> Сигналы</h2><p>Сигналы это система подписки/получения сообщений, которая эффективно заменяет SendMessage Unity3d.
Существует 2 уровня диспетчера сигналов : локальный реализован внутри класса Actor. Глобальный можно использовать из ProcessingSignals.Default.</p><p>Как использовать сигналы:</p><ol><li>Создайте новую структуру. Я предпочитаю называть их Signal<em>YourName</em>. Структура содержит все аргументы, которые вы хотите передать.</li></ol><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">struct</span> SignalCameraShake 
<span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> strength<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>Добавьте IReceive&lt;T&gt; к объекту, который будет принимать ваш сигнал. T это тип вашего сигнала.
Метод HandleSignal(T arg) будет добавлен в ваш скрипт. Это входная точка для вашего сигнала.</li></ol><div class="language-csharp extra-class"><pre class="language-csharp"><code>  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingShakeCamera</span> <span class="token punctuation">:</span> <span class="token class-name">IDisposable</span><span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">,</span> IReceive<span class="token operator">&lt;</span>SignalCameraShake<span class="token operator">&gt;</span> 
  <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">HandleSignal</span><span class="token punctuation">(</span><span class="token class-name">SignalCameraShake</span> arg<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
				tweenShakeAverage<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
				tweenShakeStrong<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
				tweenShakeVeryStrong<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>Добавьте подписку к вашему диспетчеру сигналов.</li></ol><div class="language-csharp extra-class"><pre class="language-csharp"><code>  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingShakeCamera</span> <span class="token punctuation">:</span> <span class="token class-name">IDisposable</span><span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">,</span> IReceive<span class="token operator">&lt;</span>SignalCameraShake<span class="token operator">&gt;</span> 
  <span class="token punctuation">{</span>
	
	<span class="token keyword">public</span> <span class="token function">ProcessingShakeCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
		    <span class="token comment">// подписка этого объекта на глобальный диспетчер сигналов.</span>
			ProcessingSignals<span class="token punctuation">.</span>Default<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	        <span class="token punctuation">}</span>
		
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">HandleSignal</span><span class="token punctuation">(</span><span class="token class-name">SignalCameraShake</span> arg<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
				tweenShakeAverage<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
				tweenShakeStrong<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
				tweenShakeVeryStrong<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><ol start="4"><li>Добавьте функционал отписки</li></ol><div class="language-csharp extra-class"><pre class="language-csharp"><code>  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingShakeCamera</span> <span class="token punctuation">:</span> <span class="token class-name">IDisposable</span><span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">,</span> IReceive<span class="token operator">&lt;</span>SignalCameraShake<span class="token operator">&gt;</span> 
  <span class="token punctuation">{</span>
	
	<span class="token keyword">public</span> <span class="token function">ProcessingShakeCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
		    <span class="token comment">// подписка этого объекта на глобальный диспетчер сигналов.</span>
			ProcessingSignals<span class="token punctuation">.</span>Default<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	        <span class="token punctuation">}</span>
		
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">HandleSignal</span><span class="token punctuation">(</span><span class="token class-name">SignalCameraShake</span> arg<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
				tweenShakeAverage<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
				tweenShakeStrong<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
				tweenShakeVeryStrong<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// Нам не нужно чтобы объект принимал сигоналы когда он уничтожен.</span>
			<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
		        <span class="token comment">// Отписка</span>
			ProcessingSignals<span class="token punctuation">.</span>Default<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
  <span class="token punctuation">}</span>
</code></pre></div><p>Обратите внимание, что вам не нужно реализовывать логику подписки/отписки, которая наследуется от класса behavior или actor.
Просто добавьте интерфейс IReceive :</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DecorateDamageBlink</span> <span class="token punctuation">:</span> <span class="token class-name">Behavior</span><span class="token punctuation">,</span> IReceive<span class="token operator">&lt;</span>SignalDamage<span class="token operator">&gt;</span>
  <span class="token punctuation">{</span>
   
  	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">HandleSignal</span><span class="token punctuation">(</span><span class="token class-name">SignalDamage</span> val<span class="token punctuation">)</span>
  	<span class="token punctuation">{</span>
  		<span class="token function">Blink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token punctuation">}</span>
  
  <span class="token punctuation">}</span>

</code></pre></div><h2 id="обзор-интерфейсов"><a href="#обзор-интерфейсов" aria-hidden="true" class="header-anchor">#</a><strong>Обзор интерфейсов</strong></h2><p>Фреймворк содержит в себе несколько интерфейсов для расширения функциональности сущностей.</p><h3 id="itick"><a href="#itick" aria-hidden="true" class="header-anchor">#</a> ITick</h3><p>Фреймворк использует одно обновление monobehaviour для <em>ВСЕХ</em> сущностей. Поэтому мы не используем никаких методов обновления в акторах/поведениях.
Вместо этого мы помечаем акторов и поведения интерфейсами для определения типа обновления. Используйте Tick, если у вас есть код, который должен выполняться каждый кадр.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BehaviorExample</span> <span class="token punctuation">:</span> <span class="token class-name">Behavior</span><span class="token punctuation">,</span> ITick<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="itickfixed"><a href="#itickfixed" aria-hidden="true" class="header-anchor">#</a> ITickFixed</h3><p>Используйте его, когда у вас есть код, который должен работать через определенное количество кадров.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BehaviorExample</span> <span class="token punctuation">:</span> <span class="token class-name">Behavior</span><span class="token punctuation">,</span> ITickFixed<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">OnTickFixed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="iticklate"><a href="#iticklate" aria-hidden="true" class="header-anchor">#</a> ITickLate</h3><p>Используйте его, когда у вас есть код, который должен работать после всех других обновлений.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BehaviorExample</span> <span class="token punctuation">:</span> <span class="token class-name">Behavior</span><span class="token punctuation">,</span> ITickLate<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">OnTickLate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="idata"><a href="#idata" aria-hidden="true" class="header-anchor">#</a> IData</h3><p>Используйте его, когда вы хотите отметить класс как контейнер данных. Помните, что вам нужно использовать атрибут [System.Serializable] для контейнеров данных.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">System<span class="token punctuation">.</span>Serializable</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataExample</span> <span class="token punctuation">:</span> <span class="token class-name">IData</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="isetup"><a href="#isetup" aria-hidden="true" class="header-anchor">#</a> ISetup</h3><p>Иногда необходима настройка компонента данных после запуска приложения. Наследуйте компонент данных от интерфейса ISetup, чтобы предоставить дополнительную настройку. Когда они будут добавлены к актору он проверит все компоненты на наличие интерфейса ISetup и запустит их.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">System<span class="token punctuation">.</span>Serializable</span><span class="token punctuation">]</span>    
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataRender</span><span class="token punctuation">:</span> <span class="token class-name">ISetup</span><span class="token punctuation">,</span> IData
<span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token class-name">MaterialPropertyBlock</span> matPropBlock<span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> ID <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
 
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Setup</span><span class="token punctuation">(</span><span class="token class-name">Actor</span> actor<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
			<span class="token keyword">var</span> rend <span class="token operator">=</span> actor<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Get</span><span class="token punctuation">&lt;</span><span class="token class-name">SpriteRenderer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;view&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			matPropBlock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MaterialPropertyBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			rend<span class="token punctuation">.</span><span class="token function">GetPropertyBlock</span><span class="token punctuation">(</span>matPropBlock<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		source <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="imustbewipedout"><a href="#imustbewipedout" aria-hidden="true" class="header-anchor">#</a> IMustBeWipedOut</h3><p>Интерфейс IMustBeWipedOut отмечает обработчики, которые должны быть удалены из Тулбокса при изменении сцены.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingShakeCamera</span> <span class="token punctuation">:</span> <span class="token class-name">IDisposable</span><span class="token punctuation">,</span> IMustBeWipedOut 
  <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="ireceive"><a href="#ireceive" aria-hidden="true" class="header-anchor">#</a> IReceive&lt;T&gt;</h3><p>Интерфейс IReceive&lt;T&gt; используется, когда вы хотите, чтобы объект получал сигнал с типом T от локального диспетчера сигналов. IReceive&lt;T&gt; обычно используется внутри акторов для местной связи.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingShakeCamera</span> <span class="token punctuation">:</span> <span class="token class-name">IDisposable</span><span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">,</span> IReceive<span class="token operator">&lt;</span>SignalCameraShake<span class="token operator">&gt;</span> 
  <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">HandleSignal</span><span class="token punctuation">(</span><span class="token class-name">SignalCameraShake</span> arg<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
				tweenShakeAverage<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
				tweenShakeStrong<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
				tweenShakeVeryStrong<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="ireceiveglobal"><a href="#ireceiveglobal" aria-hidden="true" class="header-anchor">#</a> IReceiveGlobal&lt;T&gt;</h3><p>Интерфейс IReceiveGlobal&lt;T&gt; используется, когда вы хотите, чтобы объект получал сигнал с типом T от глобального диспетчера сигналов.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingShakeCamera</span> <span class="token punctuation">:</span> <span class="token class-name">IDisposable</span><span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">,</span> IReceiveGlobal<span class="token operator">&lt;</span>SignalCameraShake<span class="token operator">&gt;</span> 
  <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">HandleSignal</span><span class="token punctuation">(</span><span class="token class-name">SignalCameraShake</span> arg<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
				tweenShakeAverage<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
				tweenShakeStrong<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>strength <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
				tweenShakeVeryStrong<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><h2 id="toolbox"><a href="#toolbox" aria-hidden="true" class="header-anchor">#</a> Toolbox</h2><p>Toolbox это синглтон, который содержит все обработчики, глобальные данные и все, что вы хотите получить от глобального доступа.
Думайте о тулбоксе как о &quot; глобальном акторе.&quot;</p><p>Чтобы добавить новый экземпляр класса в тулбокса, используйте метод Add
Пример:</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>Toolbox<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">ProcessingInputConnect</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Чтобы получить что-то из тулбокса, используйте метод Get
Пример:</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>data <span class="token operator">=</span> Toolbox<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Get</span><span class="token punctuation">&lt;</span><span class="token class-name">DataGameSession</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="обработчики"><a href="#обработчики" aria-hidden="true" class="header-anchor">#</a> Обработчики</h2><p>Обработчики более известны как &quot;менеджеры&quot;, &quot;контроллеры&quot;. Обработчики - это классы, которые могут использоваться как системы в ECS или выполнять некоторую глобальную работу. Например скрипт следования камеры является хорошим кандидатом для обработчика.</p><p>Существует несколько готовых обработчиков во фреймворке. Вы можете найти их в StarterKernel. Лучшее место для добавления пользовательских обработчиков это Starter скрипты или pluggables.</p><p>Обработчики должны жить только внутри тулбокса.</p><h3 id="processingbase"><a href="#processingbase" aria-hidden="true" class="header-anchor">#</a> ProcessingBase</h3><p>Как правило, обработчики должны быть унаследованы от ProcessingBase, но можно использовать их без него.
ProcessingBase необходим для использования скрипта в качестве ECS системы. Кроме того, он автоматизирует процедуру подписки/отписки на сигналы.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingGroupEnemies</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span>
</code></pre></div><h3 id="imustbewipedout-2"><a href="#imustbewipedout-2" aria-hidden="true" class="header-anchor">#</a> IMustBeWipedOut</h3><p>Интерфейс IMustBeWipedOut говорит тулбоксу, что этот обработчик должен быть уничтожен при изменении сцены. Обычно он используется со всеми &quot;локальными&quot; сценариями обработки, связанными только с одной сценой. Иногда лучше уничтожить объект и воссоздать его на новой сцене.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingGroupEnemies</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span><span class="token punctuation">,</span> IMustBeWipedOut
</code></pre></div><h3 id="idisposable"><a href="#idisposable" aria-hidden="true" class="header-anchor">#</a> IDisposable</h3><p>Используйте интерфейс IDisposable, если вы хотите очистить объект обработки перед его уничтожением.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingShakeCamera</span> <span class="token punctuation">:</span> <span class="token class-name">IDisposable</span><span class="token punctuation">,</span> IMustBeWipedOut
<span class="token punctuation">{</span>

	    <span class="token keyword">private</span> <span class="token class-name">Tween</span> twShakeFromShootCamera<span class="token punctuation">;</span>
		<span class="token keyword">private</span> <span class="token class-name">Tween</span> twShakeAverage<span class="token punctuation">;</span>
		<span class="token keyword">private</span> <span class="token class-name">Tween</span> twShakeStrong<span class="token punctuation">;</span>
		<span class="token keyword">private</span> <span class="token class-name">Tween</span> twShakeVeryStrong<span class="token punctuation">;</span>


		<span class="token keyword">public</span> <span class="token function">ProcessingShakeCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			ProcessingSignals<span class="token punctuation">.</span>Default<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

	        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			ProcessingSignals<span class="token punctuation">.</span>Default<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			twShakeFromShootCamera<span class="token punctuation">.</span><span class="token function">Kill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			twShakeAverage<span class="token punctuation">.</span><span class="token function">Kill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			twShakeStrong<span class="token punctuation">.</span><span class="token function">Kill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Не используйте IDisposabl при наследовании от ProcessingBase. Он уже включен в него и вы получаете виртуальный метод
OnDispose для очистки.</p><h3 id="обновnение-обработчиков"><a href="#обновnение-обработчиков" aria-hidden="true" class="header-anchor">#</a> Обновление Обработчиков</h3><p>Не забудьте использовать интерфейсы ITick, ITickFixed, и ITickLate с обработчиками, которые вы хотите обновлять каждый кадр.
Использовать ProcessingUpdate.Default.Add, чтобы зарегистрировать этот объект как Tickable.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>ProcessingUpdate<span class="token punctuation">.</span>Default<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Не забывайте помечать тип обновлений. Здесь мы используем ITickLate</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingCameraFollow</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span><span class="token punctuation">,</span> ITickLate<span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token function">ProcessingCameraFollow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			transformCamera <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span>transform<span class="token punctuation">;</span>
			<span class="token comment">// используйте ProcessingUpdate.Default.Add для регистрации объекта как Tickable. </span>
			<span class="token comment">// В нашем примере он будет добавлен как TickLate</span>
			ProcessingUpdate<span class="token punctuation">.</span>Default<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="обработчики-фреймворка"><a href="#обработчики-фреймворка" aria-hidden="true" class="header-anchor">#</a> Обработчики фреймворка</h2><p>Фреймворк не может работать без некоторых подготовленных обработчиков и вы должны о них знать.</p><h3 id="processingupdate"><a href="#processingupdate" aria-hidden="true" class="header-anchor">#</a> ProcessingUpdate</h3><p>Важный обработчик, который контролирует <em>ВСЕ</em> обновления в игре. Когда ProcessingUpdate создается он добавляет ComponentUpdate monobehavior внутрть корневого объекта [KERNEL] для получения методов обновления Unity. Все акторы, таймеры, обработчики должны работать от ProcessingUpdate.</p><p>Тогда как обновления Monobehavior могут быть использованы только в наследующих его компонентах, вы можете использовать ProcessingUpdate с <em>ЛЮБЫМ</em> скриптом.
Вы можете сделать это в 2 шага:</p><ol><li>Унаследуйтесь от нужных вам интерфейсов.</li></ol><ul><li>ITick для Update</li><li>ITickFixed для FixedUpdate</li><li>ITickLate для LateUpdate</li></ul><ol start="2"><li>Вызовите <em>ProcessingUpdate.Default.Add(this);</em> в любом месте внутри скрипта, чтобы проинициализировать его.</li><li>Обычно все обновления уничтожаются при смене сцены, но если вам нужно сделать это раньше вызовите <em>ProcessingUpdate.Default.Remove(this);</em></li></ol><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCustomClass</span> <span class="token punctuation">:</span> <span class="token class-name">ITick</span><span class="token punctuation">{</span>

 <span class="token keyword">public</span> <span class="token function">MyCustomClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   ProcessingUpdate<span class="token punctuation">.</span>Default<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			 
 <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="как-сменить-сцену"><a href="#как-сменить-сцену" aria-hidden="true" class="header-anchor">#</a> Как сменить сцену</h3><p>Для начала добавьте все нужные сцены в окне Build Settings.
Затем сгенерируйте имена сцен:</p><p><a href="https://gyazo.com/8507135cf74cf0dd1c4b9db90363a6ad" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/8507135cf74cf0dd1c4b9db90363a6ad.gif" alt="https://gyazo.com/8507135cf74cf0dd1c4b9db90363a6ad"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>Теперь сменяйте сцены используя ProcessingSceneLoad.To(int level).</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// пример уровная с ID 2</span>
<span class="token keyword">int</span> level <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
ProcessingSceneLoad<span class="token punctuation">.</span><span class="token function">To</span><span class="token punctuation">(</span>level<span class="token punctuation">)</span>
</code></pre></div><h2 id="пуn-объектов"><a href="#пуn-объектов" aria-hidden="true" class="header-anchor">#</a> Пул объектов</h2><p>Каждый раз при создании/удалении объекта для этого выделяется память. Чем сложнее объект тем больше памяти выделяется для него. Это не так сложно созда объект один или несколько раз, но когда вам нужно создавать сотни объектов или вам нужно создавать их быстро вам нужно будет использовать пул объектов. Больше информации об этом вы можете найти на <a href="https://unity3d.com/learn/tutorials/topics/scripting/object-pooling" target="_blank" rel="noopener noreferrer">сайте Unity3d<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p><p>Во фреймворке существует два типа пулов :</p><ul><li>Для GameObject - любые относящиеся к игре объекты с классом monobehavior.</li><li>Для объектов c# - любые простые классы c#. Например таймеры.</li></ul><h3 id="пуn-gameobject"><a href="#пуn-gameobject" aria-hidden="true" class="header-anchor">#</a> Пул GameObject</h3><p>Управляемый пул gameobject'ов создается с помощью скриптов ProcessingGoPool и PoolStash.
Пулы подготовлены заранее и включают в себя объекты monocached.
Всего их существует 4 типа:</p><ul><li>Pool.UI - для любых относящихся к UI сущностей</li><li>Pool.Projectiles - для любых спецэффектов и таких мелких объектов как пули.</li><li>Pool.Entities - для gameobject'ов и акторов</li><li>Pool.Audio - для звуковых объектов</li></ul><p>Так же, если вам нужно, вы можете добавить новые типы пулов с помощью ProcessingGoPool.</p><h4 id="как-добавить-объект-в-пуn"><a href="#как-добавить-объект-в-пуn" aria-hidden="true" class="header-anchor">#</a> Как добавить объект в пул</h4><p>Шаг первый.
Выберите вашего актора или monocached объект в инспекторе. Откройте вкладку Mono. Установите задержку перед уничтожением объекта.</p><p><a href="https://gyazo.com/1fc7c2a2e77a9aac8544a66712c11f01" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/1fc7c2a2e77a9aac8544a66712c11f01.gif" alt="https://gyazo.com/1fc7c2a2e77a9aac8544a66712c11f01"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>Все. Теперь при попытке уничтожения объекта он будет деактивировать и отправлен в выбранный пул.
На сцене вы можете заметить объект [POOLS]. Этот объект содержит все деактивированые сущности.</p><p><a href="https://gyazo.com/246ca65b49467779f106e4482be4b4e1" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/246ca65b49467779f106e4482be4b4e1.gif" alt="https://gyazo.com/246ca65b49467779f106e4482be4b4e1"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>Шаг второй. ( Опционально )
В случае если вам нужно добавить какую-то определенную логику при появлении/уничтожении объекта наследуйтесь от интерфейса IPoolable.
Это нужно когда вы хотите сбросить состояние объектов. Например вам не нужно что бы ваш враг появлялся с нулевым HP.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ActorEnemy</span> <span class="token punctuation">:</span> <span class="token class-name">Actor</span><span class="token punctuation">,</span> ITick<span class="token punctuation">,</span> IPoolable
</code></pre></div><p>Затем добавьте override методы в поведения (behaviour), которые используются с этим актором:</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">OnSpawn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">OnDespawn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Когда вы используете override из класса Actor не забудьте добавить base.OnSpawn()/OnDespawn()
Вам нужно cделать это т.к. базовый класс Actor зациклен через поведения и передает им методы OnSpawn()/OnDespawn().</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">OnSpawn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">OnSpawn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">OnDespawn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">OnDespawn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Таким образом, если вы тщательно планируете и проектируете, вы можете использвать пулы даже для очень сложных объектов.</p><h3 id="компонент-poolregister"><a href="#компонент-poolregister" aria-hidden="true" class="header-anchor">#</a> Компонент PoolRegister</h3><p>Если вы добавили объекты в режиме редактирования то объекты не смогут попасть в пулы просто так, их нужно будет зарегистрировать для дальнейшего использования с пулом. Для этого используйте компонент PoolRegister.
Обычно я прикрепляю его к объекту [Setup]. Он определяет узлы пула: задает тип пула, префаб объекта из проекта ( не со сцены ) и список всех готовых клонов на месте сцене. В будущем я планирую это автоматизировать.</p><p><a href="https://gyazo.com/51f7661dc970da82aa48faac0feffdfc" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/51f7661dc970da82aa48faac0feffdfc.png" alt="https://gyazo.com/51f7661dc970da82aa48faac0feffdfc"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h3 id="временный-пуn"><a href="#временный-пуn" aria-hidden="true" class="header-anchor">#</a> Временный пул</h3><p>Вы можете создать специальный временный пул для работы с ним. Это полезно когда вы хотите лениво активировать/деактивировать специфичные группы сущностей.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>ProcessingGoPool<span class="token punctuation">.</span><span class="token function">AddToTemp</span><span class="token punctuation">(</span>Pool<span class="token punctuation">.</span>Entities<span class="token punctuation">,</span> gameobject<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code>ProcessingGoPool<span class="token punctuation">.</span><span class="token function">ReleaseTemp</span><span class="token punctuation">(</span>Pool<span class="token punctuation">.</span>Entities<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="создание-и-уничтожение-новых-объектов"><a href="#создание-и-уничтожение-новых-объектов" aria-hidden="true" class="header-anchor">#</a> Создание и уничтожение новых объектов</h2><h3 id="создание-routine"><a href="#создание-routine" aria-hidden="true" class="header-anchor">#</a> Создание routine</h3><p>Чтобы использовать все возможности системы пулов и быть уверенным что объекты появлятся в нужных местах, я написал специальные методы для создания объектов.
В <em>ЛЮБОМ</em> скрипте вы можете просто использовать</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">var</span> pool <span class="token operator">=</span> Pool<span class="token punctuation">.</span>Entities<span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Populate</span><span class="token punctuation">(</span>pool<span class="token punctuation">,</span> prefab<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Вы также можете добавить дополнительные параметры:</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">var</span> pool <span class="token operator">=</span> Pool<span class="token punctuation">.</span>UI<span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Populate</span><span class="token punctuation">(</span>pool<span class="token punctuation">,</span> prefab<span class="token punctuation">,</span> Vector3<span class="token punctuation">.</span>zero<span class="token punctuation">,</span> Quaternion<span class="token punctuation">.</span>identity<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> WorldParenters<span class="token punctuation">.</span>Level<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Вы можете создавать объекты из Resources добавляя string id.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">var</span> pool <span class="token operator">=</span> Pool<span class="token punctuation">.</span>UI<span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Populate</span><span class="token punctuation">(</span>pool<span class="token punctuation">,</span> <span class="token string">&quot;myObject&quot;</span> <span class="token punctuation">,</span> Vector3<span class="token punctuation">.</span>zero<span class="token punctuation">,</span> Quaternion<span class="token punctuation">.</span>identity<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> WorldParenters<span class="token punctuation">.</span>UI<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Используемые параметры :
Pool - тип пула. Используйте Pool.None если вы не хотите спавнить объект в какой-либо пул.
Prefab или string id - объект, который вы хотите создать.
Position - позиция объека. По умолчанию Vector3.Zero.
Rotation - поворот объекта. По умолчанию Quaternion.identity.
Parent - родительский объект. Используйте этот параметр если вы хотите установить родительский объект.
WorldParenters - По умолчанию WorldParenters.Level. Создаваемый объект будет помещен внутрь этого компонента, если не был задан родительский объект.</p><p>По умолчанию объект Dynamic внутри [SCENE].
<a href="https://gyazo.com/4d3346f3fe63bb626af6ab6884271146" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/4d3346f3fe63bb626af6ab6884271146.png" alt="https://gyazo.com/4d3346f3fe63bb626af6ab6884271146"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>Когда вы создаете объект из string ID начинает работать ProcessingResources. Он смотрит внутрь папки Resources/Prefabs и пытается найти нужный объект. После этого ProcessingResources кэширует его и добавляет в логику создания. В следующий раз он выдваст вам этот объект из кеша вместо того чтобы снова смотреть внуть папки Resources.</p><p><a href="https://gyazo.com/025bca594dca7fdd3e35465bff05cb10" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/025bca594dca7fdd3e35465bff05cb10.png" alt="https://gyazo.com/025bca594dca7fdd3e35465bff05cb10"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h3 id="уничтожение-routine"><a href="#уничтожение-routine" aria-hidden="true" class="header-anchor">#</a> Уничтожение routine</h3><p>Что бы уничтожить актора или объект monocached используйте метод HandleDestroyGO().</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>actor<span class="token punctuation">.</span><span class="token function">HandleDestroyGO</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Если объект относится к пулу он будет деактивирован для дальнейшего использования. Если же объект не относится к какому-либо пулу он будет уничтожен.
Вы можете отсрочить его уничтожение, добавив DestroyDelay Time в инспекторе.</p><p><a href="https://gyazo.com/49613234129a49a1a9a923a863225618" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/49613234129a49a1a9a923a863225618.gif" alt="https://gyazo.com/49613234129a49a1a9a923a863225618"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h3 id="onbeforedestroy"><a href="#onbeforedestroy" aria-hidden="true" class="header-anchor">#</a> OnBeforeDestroy</h3><p>Используйте метод override OnBeforeDestroy() для добавления логики актору до его уничтожения. Это полезно использовать для добавления разных эффектов. Так же с помощью OnBeforeDestroy можно сбросить данные если объект добавлен в пул.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">OnBeforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="таймеры"><a href="#таймеры" aria-hidden="true" class="header-anchor">#</a> Таймеры</h2><p>Таймеры это отличное решение для отложенных действий. Я очень рекомендую использовать их вместо корутинов ( сопорограммы ) если вам нужно отложить лишь одно действие.</p><p>Существует два способа использования таймеров:</p><ul><li>Вы можете создавать новый Таймер каждый раз, когда вам нужно из пула таймеров</li><li>Вы можете кэшировать таймер и использовать его повторно.</li></ul><p>Установите время через которое таймер выполнит действие и само действие. Таймеры автоматически удаляются после того как они сработают.</p><p>Примеры таймеров:</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Создайте новый таймер из пула.</span>
Timer<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">0.1f</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span>HandleDestroyGO<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// Создайте и кешируйте таймер. В этом случает таймер ну будет работать до использования метода Restart.</span>
<span class="token keyword">var</span> alarm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Alarm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Включаем таймер.</span>
alarm<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code> Timer<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">0.1f</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">&gt;</span>
    <span class="token punctuation">{</span>
      Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Killed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      actor<span class="token punctuation">.</span><span class="token function">HandleDestroyGO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><h3 id="метод-addid"><a href="#метод-addid" aria-hidden="true" class="header-anchor">#</a> Метод AddID</h3><p>Вы можете добавить ID к таймеру. После этого вы сможете сортировать таймеры и получать список таймеров с одинаковым ID. Для ID можно использовать любой объект.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>  Timer<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">0.1f</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span>HandleDestroyGO<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">AddID</span><span class="token punctuation">(</span>actor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Например, вы можете найти все таймеры замороженных акторов и изменить timeScale.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">var</span> timers <span class="token operator">=</span> Timer<span class="token punctuation">.</span><span class="token function">FindAllTimers</span><span class="token punctuation">(</span>actor<span class="token punctuation">)</span><span class="token punctuation">;</span>
	 
	<span class="token keyword">if</span> <span class="token punctuation">(</span>timers <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
	 <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> timers<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	    <span class="token punctuation">{</span>
		timers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>timeScale <span class="token operator">=</span> <span class="token number">0.5f</span><span class="token punctuation">;</span>
	    <span class="token punctuation">}</span>
</code></pre></div><h3 id="метод-restart"><a href="#метод-restart" aria-hidden="true" class="header-anchor">#</a> Метод Restart</h3><p>Вы можете кешировать таймер для дальнейшего использования.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code> <span class="token keyword">private</span> <span class="token class-name">Timer</span> timerBlink<span class="token punctuation">;</span>
 timerBlink <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span>BlinkFinish<span class="token punctuation">,</span> <span class="token number">0.15f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 <span class="token keyword">void</span> <span class="token function">Blink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 timerBlink<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre></div><p>Вы можете изменить время или даже действие во время перезапуска</p><div class="language-csharp extra-class"><pre class="language-csharp"><code> <span class="token keyword">private</span> <span class="token class-name">Timer</span> timerBlink<span class="token punctuation">;</span>
 timerBlink <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span>BlinkFinish<span class="token punctuation">,</span> <span class="token number">0.15f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 <span class="token keyword">void</span> <span class="token function">Blink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 timerBlink<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token number">10f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 timerBlink<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token number">10f</span><span class="token punctuation">,</span> AnotherAction <span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">void</span> <span class="token function">AnotherAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 <span class="token punctuation">}</span>
</code></pre></div><h3 id="метод-kill"><a href="#метод-kill" aria-hidden="true" class="header-anchor">#</a> Метод Kill</h3><p>Если вы хотите уничтожить таймер используйте метод Kill.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>timerBlink<span class="token punctuation">.</span><span class="token function">Kill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Обычно вам нужно делать это внутри метода OnDispose.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">OnDispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
   timerBlink<span class="token punctuation">.</span><span class="token function">Kill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre></div><p>Метод OnDispose предоставляется в поведениях по умолчанию.</p><h2 id="схемы-blueprint"><a href="#схемы-blueprint" aria-hidden="true" class="header-anchor">#</a> Схемы (Blueprint)</h2><p>Схемы это ScriptableObject, который используется для определения схожих данных для акторов.
Их Настройка аналогична настройке акторов.</p><h3 id="как-создать-схему"><a href="#как-создать-схему" aria-hidden="true" class="header-anchor">#</a> Как создать схему</h3><p>Шаг 1.
Создайте новый скрипт, наследованный от Вlueprint.
Шаг 2.
Добавтье тег [CreateAssetMenu] с параметрами fileName и menuName.
Шаг 3.
Определите нужные вам компоненты данных и добавьте их с помощью метода установки в контейнер схемы.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>   <span class="token punctuation">[</span><span class="token class-name">CreateAssetMenu</span><span class="token punctuation">(</span>fileName <span class="token operator">=</span> <span class="token string">&quot;BlueprintCreature&quot;</span><span class="token punctuation">,</span> menuName <span class="token operator">=</span> <span class="token string">&quot;Blueprints/BlueprintCreature&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
   <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlueprintCreature</span> <span class="token punctuation">:</span> <span class="token class-name">Blueprint</span>
   <span class="token punctuation">{</span>
   	<span class="token punctuation">[</span><span class="token class-name">FoldoutGroup</span><span class="token punctuation">(</span><span class="token string">&quot;Setup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
   	<span class="token keyword">public</span> <span class="token class-name">DataCreature</span> dataCreature<span class="token punctuation">;</span>
   	
   	<span class="token punctuation">[</span><span class="token class-name">FoldoutGroup</span><span class="token punctuation">(</span><span class="token string">&quot;Setup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
   	<span class="token keyword">public</span> <span class="token class-name">DataDeathAnimations</span> dataDeathAnimations<span class="token punctuation">;</span>


   	<span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">Setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   	<span class="token punctuation">{</span>
   		<span class="token function">Add</span><span class="token punctuation">(</span>dataCreature<span class="token punctuation">)</span><span class="token punctuation">;</span>
   		<span class="token function">Add</span><span class="token punctuation">(</span>dataDeathAnimations<span class="token punctuation">)</span><span class="token punctuation">;</span>
   	<span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
</code></pre></div><p>Шаг 4. Создайте новый объект со схемой в проекте.</p><p><a href="https://gyazo.com/13c79e46e32bd94b19b1db89dac43306" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/13c79e46e32bd94b19b1db89dac43306.gif" alt="https://gyazo.com/13c79e46e32bd94b19b1db89dac43306"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>Шаг 5. Создайте шаблон данных схем для всех ваших акторов ( нужно сделать это всего один раз ) и добавьте этот компонент ко всем нужным акторам.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>	<span class="token punctuation">[</span><span class="token class-name">Serializable</span><span class="token punctuation">]</span>
	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataBlueprint</span> <span class="token punctuation">:</span> <span class="token class-name">IData</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">public</span> <span class="token class-name">Blueprint</span> blueprint<span class="token punctuation">;</span>
 
		<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
 
			blueprint <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">public</span> T <span class="token generic-method"><span class="token function">Get</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">where</span> T <span class="token punctuation">:</span> <span class="token keyword">class</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">return</span> blueprint<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Get</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	  
	<span class="token punctuation">}</span>
</code></pre></div><p>Шаг 6. Назначьте вашему актору нужную схему через инспектор.</p><p><a href="https://gyazo.com/c6e52a666f9d2b0a6a3c005bcef9d18d" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/c6e52a666f9d2b0a6a3c005bcef9d18d.gif" alt="https://gyazo.com/c6e52a666f9d2b0a6a3c005bcef9d18d"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>Шаг 7. Найдите Blueprints внутри папки Resources изагрузите туда вашу новую схему.
Вы можете автоматизировать этот процесс нажав на &quot;populate blueprints&quot; на панели инструментов. В этом случае все ваши схемы будут лежать в папке Assets/[2]Content/Blueprints.</p><p><a href="https://gyazo.com/7472fbc529e2e2b9f58b8f35b09a7c18" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/7472fbc529e2e2b9f58b8f35b09a7c18.gif" alt="https://gyazo.com/7472fbc529e2e2b9f58b8f35b09a7c18"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p><a href="https://gyazo.com/35b1b3c0426abe14278afe0fa107c2b8" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/35b1b3c0426abe14278afe0fa107c2b8.gif" alt="https://gyazo.com/35b1b3c0426abe14278afe0fa107c2b8"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h3 id="как-испоnьзовать-схемы-в-коде"><a href="#как-испоnьзовать-схемы-в-коде" aria-hidden="true" class="header-anchor">#</a> Как использовать схемы в коде?</h3><p>Это легко и просто : используйте метод Get внутри ваших поведений.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Get&lt;DataBlueprint&gt;() возвращает схему.</span>
<span class="token comment">// Get&lt;DataWeapon&gt; возвращает нужные данные из схемы.</span>
<span class="token keyword">var</span> weaponData <span class="token operator">=</span> <span class="token generic-method"><span class="token function">Get</span><span class="token punctuation">&lt;</span><span class="token class-name">DataBlueprint</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Get</span><span class="token punctuation">&lt;</span><span class="token class-name">DataWeapon</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="когда-нужно-испоnьзовать-схемы"><a href="#когда-нужно-испоnьзовать-схемы" aria-hidden="true" class="header-anchor">#</a> Когда нужно использовать схемы ?</h3><p>Все переменные, добавляемые вами к gameobject'ам чего-то стоят. Например, создание 1 000 000 объектов с одной целочисленной переменной займет около 4МВ памяти. Схема создается всего 1 раз, после чего её могут использовать все копии ваших акторов. Например вам надо добавить звук для вашего монстра. Вы можете использовать схему монстра и задать звук в ней. В таком случает будет не важно сколько копий монстра вы поместите на сцену, ведь их звуки будут находиться в схеме, а не в каждом из них.</p><h2 id="теги"><a href="#теги" aria-hidden="true" class="header-anchor">#</a> Теги</h2><p>Теги это связующее звено для вашей игры: Вы можете отличать нужных вам акторов или использовать их как аргументы для ваших сигналов. Теги это простые целочисленные (INT) константы.</p><h3 id="как-добавnять"><a href="#как-добавnять" aria-hidden="true" class="header-anchor">#</a> Как добавлять</h3><p>Шаг 1.
Создайте новый static скрипт, названный Tag ( или так как вам надо ).
Я предпочитаю использовать partial классы для разделения моих тегов по разным файлам.
Назначьте вашим тегам уникальные ID.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">Tag</span>
	<span class="token punctuation">{</span>
		 <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> SignalStasisOn <span class="token operator">=</span> <span class="token number">10001</span><span class="token punctuation">;</span>
		 <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> SignalStasisOff <span class="token operator">=</span> <span class="token number">10002</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">Tag</span>
	<span class="token punctuation">{</span>
		 <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> WeaponGun <span class="token operator">=</span> <span class="token number">9000</span><span class="token punctuation">;</span>
		 <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> WeaponLaser <span class="token operator">=</span> <span class="token number">9001</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre></div><p><a href="https://gyazo.com/0eb286e0d8b2712b9b3aee03eaaec9c9" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/0eb286e0d8b2712b9b3aee03eaaec9c9.png" alt="https://gyazo.com/0eb286e0d8b2712b9b3aee03eaaec9c9"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>Шаг 2.
Добавьте [TagField(categoryName = &quot;ВАШЕИМЯ&quot;)] до тега. Используйте '/' для добавления тегов в отдельные группы.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">Tag</span>
	<span class="token punctuation">{</span>
		<span class="token punctuation">[</span><span class="token class-name">TagField</span><span class="token punctuation">(</span>categoryName <span class="token operator">=</span> <span class="token string">&quot;Weapons&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> WeaponGun <span class="token operator">=</span> <span class="token number">9000</span><span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">TagField</span><span class="token punctuation">(</span>categoryName <span class="token operator">=</span> <span class="token string">&quot;Weapons/BigGuns&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> WeaponLaser <span class="token operator">=</span> <span class="token number">9001</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>Шаг 3.
Добавьте тег к вашему актору. Для этого используйте tags.Add(ВАШ_ТЕГ);</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ActorPlayer</span> <span class="token punctuation">:</span> <span class="token class-name">Actor</span><span class="token punctuation">{</span>
	<span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">Setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataAnimationState<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataCurrentWeapon<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// всегда добавляйте теги в конце настроек актора.</span>
			tags<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>GroupPlayer<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Шаг 4.
Вы можете редактировать ваши теги из инспектора. Для этого добавьте int переменную там, где вам надо и прикрепите атрибут
[TagFilter(typeof(ТИП_КЛАСА_С_ТЕГАМИ))]</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ActorPlayer</span> <span class="token punctuation">:</span> <span class="token class-name">Actor</span><span class="token punctuation">{</span>
<span class="token punctuation">[</span><span class="token class-name">TagFilter</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>Tag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">int</span> tag<span class="token punctuation">;</span>
	<span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">Setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataAnimationState<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataCurrentWeapon<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// всегда добавляйте теги в конце настроек актора.</span>
			tags<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://gyazo.com/e3c0c4d009209b46df72975305a6e936" target="_blank" rel="noopener noreferrer"><img src="https://i.gyazo.com/e3c0c4d009209b46df72975305a6e936.gif" alt="https://gyazo.com/e3c0c4d009209b46df72975305a6e936"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h3 id="processingtags"><a href="#processingtags" aria-hidden="true" class="header-anchor">#</a> ProcessingTags</h3><p>Акторы содержат специальный компонент processingTags.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Добавление одного тега.</span>
tags<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Добавление нескольких тегов.</span>
tags<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> tag2<span class="token punctuation">,</span> tag3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code> <span class="token comment">// Удаление одного тегда.</span>
tags<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code>  <span class="token comment">// Удаление всех похожих тегов.</span>
tags<span class="token punctuation">.</span><span class="token function">RemovAll</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code>   <span class="token comment">// должен быть указанный тег.</span>
 <span class="token keyword">bool</span> valid <span class="token operator">=</span> tags<span class="token punctuation">.</span><span class="token function">Contain</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code>  <span class="token comment">// должен быть как минимум один тег.</span>
<span class="token keyword">bool</span> valid <span class="token operator">=</span> tags<span class="token punctuation">.</span><span class="token function">ContainAny</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span>tag2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code>  <span class="token comment">// должны быть все теги.</span>
<span class="token keyword">bool</span> valid <span class="token operator">=</span> tags<span class="token punctuation">.</span><span class="token function">ContainAll</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span>tag2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="как-испоnьзовать"><a href="#как-испоnьзовать" aria-hidden="true" class="header-anchor">#</a> Как использовать</h3><p>Вы можете добавлять одни и те же теги актору. Это полезно в случае, когда у вас есть несколько действий с одинаковой логикой, и вы хотите проверить что-то.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Добавление тега stun от могучего молота судьбы.</span>
tags<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>Stunned<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Добавление тег stun от упавшего дерева.</span>
tags<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>Stunned<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Удаление тега, вызванного могучим молотом судьбы. </span>
tags<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>Stunned<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> condition_stunned <span class="token operator">=</span> tags<span class="token punctuation">.</span><span class="token function">Contain</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>Stunned<span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><p>В примере выше condition_stunned будет истинным, т.к. нужный тег был дважды добавлен, но удален только один раз.</p><h2 id="ecs"><a href="#ecs" aria-hidden="true" class="header-anchor">#</a> ECS</h2><p>Простой ECS паттерн для работы с акторами. В данный момент мой подход может быть использован только с классами акторов и он далеко не так хорош как чистый ECS подход и он использует больше структурирования для увеличения производительности.</p><h3 id="обработчики-aka-системы"><a href="#обработчики-aka-системы" aria-hidden="true" class="header-anchor">#</a> Обработчики ( aka системы )</h3><p>Обработчиками я называю все системы или глобальные &quot;контролеры&quot;.</p><p>Когда вам надо активировать ECS наследуйте ваши обработчики от ProcessingBase</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingCameraFollow</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span><span class="token punctuation">,</span> ITick<span class="token punctuation">,</span> IMustBeWipedOut
</code></pre></div><p>Для использования ваших обработчиков вам нужно добавить их в тулбокс. Обычно я делаю это в starter скриптах.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code>	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StarterLv1</span> <span class="token punctuation">:</span> <span class="token class-name">Starter</span>
	<span class="token punctuation">{</span>
		<span class="token punctuation">[</span><span class="token class-name">FoldoutGroup</span><span class="token punctuation">(</span><span class="token string">&quot;Setup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SerializeField<span class="token punctuation">,</span> HideInInspector<span class="token punctuation">]</span>
		<span class="token keyword">private</span> <span class="token class-name">DataLevel</span> dataLevel<span class="token punctuation">;</span>

		<span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">Setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			Toolbox<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Get</span><span class="token punctuation">&lt;</span><span class="token class-name">DataGameSession</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>currentLevel <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

			Toolbox<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">ProcessingGroupPlayers</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			Toolbox<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">ProcessingGroupEnemies</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			Toolbox<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">ProcessingSortDepth</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			Toolbox<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">ProcessingShakeCamera</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			Toolbox<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">ProcessingCameraFollow</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			Toolbox<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">ProcessingInputConnect</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			Toolbox<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token punctuation">&lt;</span><span class="token class-name">ProcessingMenuHome</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>Запомните что если вам надо вы можете наследоваться от класса Starter.</p><h3 id="обработчики-групп"><a href="#обработчики-групп" aria-hidden="true" class="header-anchor">#</a> Обработчики групп</h3><p>Когда новая сущность актора добавляется в ProcessingEntities скрипт решает в какую группу актеров он должен быть помещен.
Группы это листы с акторами, имеющими общий фильтр.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingCameraFollow</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span><span class="token punctuation">,</span> ITick<span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">{</span>

<span class="token keyword">private</span> <span class="token class-name">Group</span> groupPlayers<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="фиnьтры"><a href="#фиnьтры" aria-hidden="true" class="header-anchor">#</a> Фильтры</h3><p>Для заполнения вашей группы вам нужно добавить фильтры. Думайте о фильтре как о замке. Если ваш ключи подходит к замку - актор добавляется в группу. Вы можете фильтровать акторов по типу компонентов данных или по тегам.</p><h4 id="фиnьтр-groupby"><a href="#фиnьтр-groupby" aria-hidden="true" class="header-anchor">#</a> Фильтр GroupBy</h4><p>Для заполнения группы добавьте атрибут GroupBy на переменной в которой вы будете хранить эту группу.
Все ваши GrouBy фильтры должны быть действительными для добавления акторов в группы.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingCameraFollow</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span><span class="token punctuation">,</span> ITick<span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">{</span>
<span class="token punctuation">[</span><span class="token class-name">GroupBy</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>DataPlayer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">private</span> <span class="token class-name">Group</span> groupPlayers<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Вы можете использовать несколько фильтров :</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingCameraFollow</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span><span class="token punctuation">,</span> ITick<span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">{</span>
<span class="token punctuation">[</span><span class="token class-name">GroupBy</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>DataPlayer<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>DataKnight<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">private</span> <span class="token class-name">Group</span> groupPlayersKnights<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="испоnьзование-тегов-вместо-типов"><a href="#испоnьзование-тегов-вместо-типов" aria-hidden="true" class="header-anchor">#</a> Использование тегов вместо типов</h5><p>Вам не обязательно использовать типы компонентов данных для фильтрации. Вместо них вы можете использовать теги.
Тег это простая целочисленная (int) константа. Он очень поход на теги для GameObject'ов из Unity3D, но он более мощный.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// создайте static класс Tag и добавьте все ваши константы сюда.</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">Tag</span>
	<span class="token punctuation">{</span>
		<span class="token punctuation">[</span><span class="token class-name">TagField</span><span class="token punctuation">(</span>categoryName <span class="token operator">=</span> <span class="token string">&quot;Groups&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> GroupPlayer <span class="token operator">=</span> <span class="token number">2001</span><span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">TagField</span><span class="token punctuation">(</span>categoryName <span class="token operator">=</span> <span class="token string">&quot;Groups&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> GroupEnemy <span class="token operator">=</span> <span class="token number">2002</span><span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">TagField</span><span class="token punctuation">(</span>categoryName <span class="token operator">=</span> <span class="token string">&quot;Groups&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> GroupPlayerSpawner <span class="token operator">=</span> <span class="token number">2003</span><span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">TagField</span><span class="token punctuation">(</span>categoryName <span class="token operator">=</span> <span class="token string">&quot;Groups&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> GroupDragable <span class="token operator">=</span> <span class="token number">2004</span><span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">TagField</span><span class="token punctuation">(</span>categoryName <span class="token operator">=</span> <span class="token string">&quot;Groups&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> GroupPlayerUI <span class="token operator">=</span> <span class="token number">2005</span><span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">TagField</span><span class="token punctuation">(</span>categoryName <span class="token operator">=</span> <span class="token string">&quot;Groups&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> GroupBorders <span class="token operator">=</span> <span class="token number">2006</span><span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">TagField</span><span class="token punctuation">(</span>categoryName <span class="token operator">=</span> <span class="token string">&quot;Groups&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> GroupCameraStartPosition <span class="token operator">=</span> <span class="token number">2007</span><span class="token punctuation">;</span>
		<span class="token punctuation">[</span><span class="token class-name">TagField</span><span class="token punctuation">(</span>categoryName <span class="token operator">=</span> <span class="token string">&quot;Groups&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">int</span> GroupCounterAttacked <span class="token operator">=</span> <span class="token number">2008</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingCameraFollow</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span><span class="token punctuation">,</span> ITick<span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">{</span>
<span class="token punctuation">[</span><span class="token class-name">GroupBy</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>GroupPlayer<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">private</span> <span class="token class-name">Group</span> groupPlayers<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ActorPlayer</span> <span class="token punctuation">:</span> <span class="token class-name">Actor</span><span class="token punctuation">{</span>
	<span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">void</span> <span class="token function">Setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataAnimationState<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">Add</span><span class="token punctuation">(</span>dataCurrentWeapon<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// обычно теги добавляются в конце настройки вашего актора.</span>
			tags<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>GroupPlayer<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="фиnьтр-groupexclude"><a href="#фиnьтр-groupexclude" aria-hidden="true" class="header-anchor">#</a> Фильтр GroupExclude</h4><p>Вы можете конкретизировать, добавив фильтр GroupExclude. Если какой-то актор из группы будет содержать указанный тег то он будет из нее исключен.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingCameraFollow</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span><span class="token punctuation">,</span> ITick<span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">{</span>
<span class="token punctuation">[</span><span class="token class-name">GroupBy</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>GroupPlayer<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token class-name">GroupExclude</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>StateDead<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">private</span> <span class="token class-name">Group</span> groupPlayersAlive<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="событие-ongroupchanged"><a href="#событие-ongroupchanged" aria-hidden="true" class="header-anchor">#</a> Событие OnGroupChanged</h3><p>Вы можете добавить дополнительную логику при смене группы( когда актор добавляется в группу или удаляется из грпуппы )</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingCameraFollow</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span><span class="token punctuation">,</span> ITick<span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">{</span>
<span class="token punctuation">[</span><span class="token class-name">GroupBy</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>GroupPlayer<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">private</span> <span class="token class-name">Group</span> groupPlayers<span class="token punctuation">;</span>

   <span class="token keyword">public</span> <span class="token function">ProcessingCameraFollow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      groupPlayers<span class="token punctuation">.</span>OnGroupChanged <span class="token operator">+</span><span class="token operator">=</span> OnGroupPlayersChanged<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">OnGroupPlayersChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   	<span class="token punctuation">{</span>	 
   		 <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>groupPlayers<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   		    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Actor: &quot;</span> <span class="token operator">+</span> groupPlayers<span class="token punctuation">.</span>actors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   		 <span class="token punctuation">}</span> 
   	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="обновnение-обработчиков-2"><a href="#обновnение-обработчиков-2" aria-hidden="true" class="header-anchor">#</a> Обновление обработчиков</h3><p>Для добавления обновлений в ваши обработчики наследуйте их от интерфейсов ITick, ITIckFixed, ITickLate.
Ипользуйте group.length для получения длины контейнера. Используйте group.actors[i] для получения одного из акторов группы.</p><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProcessingCameraFollow</span> <span class="token punctuation">:</span> <span class="token class-name">ProcessingBase</span><span class="token punctuation">,</span> ITick<span class="token punctuation">,</span> IMustBeWipedOut<span class="token punctuation">{</span>
<span class="token punctuation">[</span><span class="token class-name">GroupBy</span><span class="token punctuation">(</span>Tag<span class="token punctuation">.</span>GroupPlayer<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">private</span> <span class="token class-name">Group</span> groupPlayers<span class="token punctuation">;</span>

   <span class="token keyword">public</span> <span class="token function">ProcessingCameraFollow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      groupPlayers<span class="token punctuation">.</span>OnGroupChanged <span class="token operator">+</span><span class="token operator">=</span> OnGroupPlayersChanged<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">OnGroupPlayersChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   	<span class="token punctuation">{</span>	 
   		 <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>groupPlayers<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   		    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Actor: &quot;</span> <span class="token operator">+</span> groupPlayers<span class="token punctuation">.</span>actors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   		 <span class="token punctuation">}</span> 
   	<span class="token punctuation">}</span>
   	
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>groupPlayers<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   		    <span class="token function">DoSomething</span><span class="token punctuation">(</span>groupPlayers<span class="token punctuation">.</span>actors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
    
    <span class="token keyword">void</span> <span class="token function">DoSomething</span><span class="token punctuation">(</span><span class="token class-name">Actor</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
   	
<span class="token punctuation">}</span>
</code></pre></div></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/dimmpixeye/Actors-Unity3d-Framework/edit/master/docs/src/ru/guide/basic-stuff.md" target="_blank" rel="noopener noreferrer">Редактировать эту страницу на GitHub</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><div class="last-updated"><span class="prefix">Last Updated: </span><span class="time">2018-6-27 18:00:46</span></div></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/Actors-Unity3d-Framework/ru/guide/setup.html" class="prev">
          Установка
        </a></span><!----></p></div></div></div></div>
    <script src="/Actors-Unity3d-Framework/assets/js/3.45fed496.js" defer></script><script src="/Actors-Unity3d-Framework/assets/js/app.bffbe60e.js" defer></script>
  </body>
</html>
